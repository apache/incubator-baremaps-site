(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[818],{2709:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/documentation/examples/import-contour-into-postgis",function(){return t(6347)}])},6347:function(e,n,t){"use strict";t.r(n);var s=t(5893),i=t(4319),a=t(1151);function o(e){let n=Object.assign({h1:"h1",p:"p",h2:"h2",code:"code",pre:"pre",span:"span",a:"a"},(0,a.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{children:"Contour Lines in Vector Tiles"}),"\n",(0,s.jsx)(n.p,{children:"Contour lines are a key element in topographic maps, as they allow us to\nvisualize the elevation of an area. In this tutorial, we will show you how\nto create contour lines from a digital elevation model (DEM) and display\nthem using vector tiles."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.p,{children:["To follow this tutorial, you will need to have ",(0,s.jsx)(n.code,{children:"gdal"})," installed on your\nsystem. If you don't have it already, you can install it by running the\nfollowing command:"]}),"\n",(0,s.jsx)(n.pre,{"data-language":"bash","data-theme":"default",children:(0,s.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"sudo "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"apt-get"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"install"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"gdal-bin"})]})})}),"\n",(0,s.jsx)(n.h2,{id:"reprojecting-the-geotiff",children:"Reprojecting the GeoTiff"}),"\n",(0,s.jsxs)(n.p,{children:["We will be using the ",(0,s.jsx)(n.a,{href:"https://asterweb.jpl.nasa.gov/gdem.asp",children:"ASTER"})," dataset\nfor this example. The geotiff file provided in this tutorial is already in\nthe desired projection (WebMercator), but in case you want to use a different\ngeotiff file, you can use the gdalwarp command to reproject it. Here's an\nexample of how to do it:"]}),"\n",(0,s.jsx)(n.pre,{"data-language":"text","data-theme":"default",children:(0,s.jsxs)(n.code,{"data-language":"text","data-theme":"default",children:[(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"gdalwarp -rc \\"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  -s_srs epsg:4326 -t_srs epsg:3857 \\"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  -dstnodata 0 -of GTiff -co tiled=yes \\"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  liecthenstein-aster-dem-v2.tif \\"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  liecthenstein-aster-dem-v2-3857.tif"})})]})}),"\n",(0,s.jsx)(n.h2,{id:"generating-the-contour-lines",children:"Generating the Contour Lines"}),"\n",(0,s.jsxs)(n.p,{children:["Now that we have the GeoTiff in the desired projection,\nwe can use the gdal_contour command to generate the contour lines.\nThe ",(0,s.jsx)(n.code,{children:"-a"})," argument specifies the column that contains the elevation data,\nthe ",(0,s.jsx)(n.code,{children:"-i"})," argument specifies the interval at which contours\nshould be generated (in this case, we are using 10 meters),\nand the ",(0,s.jsx)(n.code,{children:"-nln"})," argument names the table that will contain the data."]}),"\n",(0,s.jsx)(n.pre,{"data-language":"text","data-theme":"default",children:(0,s.jsxs)(n.code,{"data-language":"text","data-theme":"default",children:[(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"gdal_contour \\"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  -a elevation -nln aster_dem -i 10 \\"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  -f PostgreSQL \\"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:'  liecthenstein-aster-dem-v2-3857.tif "PG:host=localhost user=baremaps password=baremaps dbname=baremaps"'})})]})}),"\n",(0,s.jsx)(n.h2,{id:"improving-performance-with-indexes",children:"Improving Performance with Indexes"}),"\n",(0,s.jsxs)(n.p,{children:["To improve the performance of the contour lines,\nwe can add some indexes to the database.\nHere's an example of how to create a ",(0,s.jsx)(n.code,{children:"SPGIST"})," index:"]}),"\n",(0,s.jsx)(n.pre,{"data-language":"postgresql","data-theme":"default",children:(0,s.jsxs)(n.code,{"data-language":"postgresql","data-theme":"default",children:[(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"DROP INDEX IF EXISTS aster_dem_gix;"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"CREATE INDEX IF NOT EXISTS aster_dem_gix ON aster_dem USING SPGIST(wkb_geometry);"})})]})}),"\n",(0,s.jsx)(n.h2,{id:"displaying-the-contour-lines",children:"Displaying the Contour Lines"}),"\n",(0,s.jsx)(n.p,{children:"Finally, we can use Baremaps to display the contour lines in a web browser.\nTo do this, run the following command:"}),"\n",(0,s.jsx)(n.pre,{"data-language":"bash","data-theme":"default",children:(0,s.jsxs)(n.code,{"data-language":"bash","data-theme":"default",children:[(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"baremaps "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"map"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"dev"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" \\"})]}),"\n",(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--tileset"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'tileset.json'"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" \\"})]}),"\n",(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--style"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'style.json'"})]})]})}),"\n",(0,s.jsx)(n.p,{children:"This will start the tile server and automatically reload the configuration\nfiles when you make changes. You can then preview the map in your\nweb browser."}),"\n",(0,s.jsx)(n.h2,{id:"optional-smoothing-the-contour-lines",children:"Optional: Smoothing the Contour Lines"}),"\n",(0,s.jsx)(n.p,{children:"If you want to improve the rendering of the contour lines, you can use\na smoothing function like ST_ChaikinSmoothing. This function takes\na geometry as input and returns a smoothed version of that geometry.\nHere's an example of how you could use it:"}),"\n",(0,s.jsx)(n.pre,{"data-language":"postgresql","data-theme":"default",children:(0,s.jsxs)(n.code,{"data-language":"postgresql","data-theme":"default",children:[(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"UPDATE aster_dem"})}),"\n",(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"SET wkb_geometry = ST_ChaikinSmoothing(wkb_geometry, 0.1)"})})]})}),"\n",(0,s.jsx)(n.p,{children:"Keep in mind that this step is optional and might not be necessary depending\non the quality of your input data. You can experiment with different\nsmoothing parameters to find the best balance between smoothness and\npreservation of original features."}),"\n",(0,s.jsx)(n.p,{children:"That's it! You now know how to generate and display contour lines from\na digital elevation model using vector tiles. Happy mapping!"})]})}t(5675),n.default=(0,i.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)},pageOpts:{filePath:"src/pages/documentation/examples/import-contour-into-postgis.mdx",route:"/documentation/examples/import-contour-into-postgis",frontMatter:{layout:"default",title:"Contour Lines in Vector Tiles"},headings:[{depth:1,value:"Contour Lines in Vector Tiles",id:"contour-lines-in-vector-tiles"},{depth:2,value:"Prerequisites",id:"prerequisites"},{depth:2,value:"Reprojecting the GeoTiff",id:"reprojecting-the-geotiff"},{depth:2,value:"Generating the Contour Lines",id:"generating-the-contour-lines"},{depth:2,value:"Improving Performance with Indexes",id:"improving-performance-with-indexes"},{depth:2,value:"Displaying the Contour Lines",id:"displaying-the-contour-lines"},{depth:2,value:"Optional: Smoothing the Contour Lines",id:"optional-smoothing-the-contour-lines"}],title:"Contour Lines in Vector Tiles"},pageNextRoute:"/documentation/examples/import-contour-into-postgis"})}},function(e){e.O(0,[319,774,888,179],function(){return e(e.s=2709)}),_N_E=e.O()}]);